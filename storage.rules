
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Match any file in the assets directory
    match /assets/{ownerId}/{jobId}/{filePath=**} {
      // Only the user who owns the job can write to the job's folder.
      allow write: if request.auth != null && request.auth.uid == ownerId;

      // Only the user who owns the job can read their assets.
      allow read: if request.auth != null && request.auth.uid == ownerId;
    }

    // Security for other paths can be added here
    // For example, you might have a 'user_profiles' directory
    match /user_profiles/{userId}/profile_picture.jpg {
        allow read: if true;
        allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
